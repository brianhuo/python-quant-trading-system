# ğŸ“Š DataHealthChecker ä¼˜åŒ–æ–¹æ¡ˆåˆ†ææŠ¥å‘Š

## ğŸ“‹ åŸå§‹å®ç°åˆ†æ

### ğŸ” å½“å‰ç‰ˆæœ¬ç‰¹ç‚¹
æ‚¨çš„åŸå§‹`DataHealthChecker`è„šæœ¬å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š

#### âœ… ä¼˜ç‚¹ï¼š
- **åŸºç¡€å¥åº·æ£€æŸ¥åŠŸèƒ½** - æä¾›äº†ç¼ºå¤±å€¼ã€é›¶å€¼ã€å¼‚å¸¸å€¼æ£€æµ‹
- **ç®€å•æ˜“ç”¨** - æ¥å£ç›´è§‚ï¼Œä½¿ç”¨æ–¹ä¾¿
- **åŸºç¡€ç»Ÿè®¡ä¿¡æ¯** - åŒ…å«åŸºæœ¬çš„æ•°æ®è´¨é‡ç»Ÿè®¡

#### âš ï¸ å±€é™æ€§ï¼š
- **åŠŸèƒ½æœ‰é™** - æ£€æŸ¥é¡¹ç›®ä¸å¤Ÿå…¨é¢
- **æ¸…æ´—èƒ½åŠ›å¼±** - ä¸»è¦æ˜¯æ£€æµ‹ï¼Œç¼ºä¹æ·±åº¦æ¸…æ´—åŠŸèƒ½
- **æŠ¥å‘Šç®€å•** - ç¼ºä¹è¯¦ç»†çš„åˆ†ææŠ¥å‘Š
- **é…ç½®å›ºåŒ–** - é˜ˆå€¼ç¡¬ç¼–ç ï¼Œçµæ´»æ€§ä¸è¶³
- **æ—¶é—´å¤„ç†æœ‰é™** - æ—¶é—´è¿ç»­æ€§æ£€æŸ¥è¾ƒä¸ºåŸºç¡€

## ğŸš€ å¢å¼ºç‰ˆä¼˜åŒ–æ–¹æ¡ˆ

### ğŸ“ˆ æ ¸å¿ƒè®¾è®¡ç†å¿µ

æˆ‘ä»¬åŸºäºæ‚¨çš„è®¾è®¡é¢„æœŸï¼Œåˆ›å»ºäº†**ä¼ä¸šçº§æ•°æ®å¥åº·æ£€æŸ¥å’Œæ¸…æ´—ç³»ç»Ÿ**ï¼š

```
4. DataHealthChecker (æ•°æ®å¥åº·æ£€æŸ¥)
* åŠŸèƒ½ï¼šéªŒè¯æ•°æ®è´¨é‡ âœ… å¤§å¹…å¢å¼º
* è¾“å…¥ï¼šåŸå§‹æ•°æ® âœ… æ”¯æŒå¤šç§æ ¼å¼
* è¾“å‡ºï¼šæ¸…æ´—åæ•°æ® âœ… å®Œæ•´æ¸…æ´—æµç¨‹
* æ£€æŸ¥é¡¹ï¼šâœ… å…¨é¢è¦†ç›–å¹¶æ‰©å±•
    * ç¼ºå¤±å€¼å¤„ç† âœ… å¤šç§ç­–ç•¥
    * å¼‚å¸¸å€¼æ£€æµ‹ âœ… IQR + Z-score
    * æ—¶é—´è¿ç»­æ€§éªŒè¯ âœ… æ·±åº¦åˆ†æ
    * æ•°æ®é¢‘ç‡ä¸€è‡´æ€§ âœ… è‡ªåŠ¨æ ‡å‡†åŒ–
```

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

#### 1. **æ ¸å¿ƒç»„ä»¶**
- **`EnhancedDataHealthChecker`** - ä¸»æ£€æŸ¥å¼•æ“
- **`DataCleaner`** - ä¸“ä¸šæ¸…æ´—å·¥å…·
- **`HealthReport`** - ç»“æ„åŒ–æŠ¥å‘Šç³»ç»Ÿ
- **`HealthIssue`** - é—®é¢˜è¿½è¸ªç³»ç»Ÿ

#### 2. **æ•°æ®æµç¨‹**
```
åŸå§‹æ•°æ® â†’ å¥åº·æ£€æŸ¥ â†’ é—®é¢˜è¯†åˆ« â†’ æ•°æ®æ¸…æ´— â†’ éªŒè¯æ¸…æ´— â†’ è¾“å‡ºæŠ¥å‘Š
```

## ğŸ” è¯¦ç»†åŠŸèƒ½å¯¹æ¯”

### ğŸ“Š **ç¼ºå¤±å€¼å¤„ç†**

#### åŸç‰ˆ vs å¢å¼ºç‰ˆï¼š
| åŠŸèƒ½ | åŸç‰ˆ | å¢å¼ºç‰ˆ |
|------|------|--------|
| **æ£€æµ‹æ–¹å¼** | ç®€å•æ£€æŸ¥ | æ·±åº¦åˆ†æå„åˆ—ç¼ºå¤±æ¨¡å¼ |
| **å¤„ç†ç­–ç•¥** | åŸºç¡€å¡«å…… | 6ç§ç­–ç•¥ï¼šåˆ é™¤/æ’å€¼/å‘å‰å¡«å……/ä¸­ä½æ•°/å‡å€¼/é›¶å¡«å…… |
| **æ™ºèƒ½è¯†åˆ«** | æ—  | è‡ªåŠ¨è¯†åˆ«ä»·æ ¼/æˆäº¤é‡ç­‰ä¸åŒåˆ—çš„æœ€ä½³å¤„ç†æ–¹æ³• |
| **æŠ¥å‘Šè¯¦ç»†åº¦** | åŸºç¡€ | è¯¦ç»†ç¼ºå¤±ç»Ÿè®¡å’Œå¤„ç†å»ºè®® |

#### å¢å¼ºç‰ˆæ ¸å¿ƒä»£ç ï¼š
```python
def check_missing_values(self, df: pd.DataFrame, report: HealthReport) -> pd.DataFrame:
    # æ·±åº¦åˆ†ææ¯åˆ—ç¼ºå¤±æ¨¡å¼
    missing_stats = df.isnull().sum()
    missing_ratios = df.isnull().mean()
    
    # æ™ºèƒ½å¤„ç†ç­–ç•¥
    for column in df.columns:
        if column in ['open', 'high', 'low', 'close']:
            df[column] = df[column].interpolate(method='linear')  # ä»·æ ¼æ’å€¼
        elif column == 'volume':
            df[column] = df[column].fillna(0)  # æˆäº¤é‡å¡«é›¶
        else:
            df[column] = df[column].ffill()  # å…¶ä»–å‘å‰å¡«å……
```

### ğŸ¯ **å¼‚å¸¸å€¼æ£€æµ‹**

#### åŸç‰ˆ vs å¢å¼ºç‰ˆï¼š
| åŠŸèƒ½ | åŸç‰ˆ | å¢å¼ºç‰ˆ |
|------|------|--------|
| **æ£€æµ‹æ–¹æ³•** | å•ä¸€æ ‡å‡†å·® | IQR + Z-score åŒé‡æ£€æµ‹ |
| **å¤„ç†ç­–ç•¥** | ä»…æŠ¥å‘Š | ä¸­ä½æ•°æ›¿æ¢/åˆ é™¤/æ’å€¼å¤šç§ç­–ç•¥ |
| **ä¸šåŠ¡é€»è¾‘** | é€šç”¨æ£€æµ‹ | é’ˆå¯¹é‡‘èæ•°æ®ç‰¹åŒ–ï¼ˆä»·æ ¼/æˆäº¤é‡ï¼‰ |
| **é˜ˆå€¼é…ç½®** | å›ºå®š | å¯é…ç½®çš„åŠ¨æ€é˜ˆå€¼ |

#### å¢å¼ºç‰ˆæ ¸å¿ƒä»£ç ï¼š
```python
def detect_outliers(self, df: pd.DataFrame, report: HealthReport) -> pd.DataFrame:
    # IQRæ–¹æ³•
    Q1 = df[column].quantile(0.25)
    Q3 = df[column].quantile(0.75)
    IQR = Q3 - Q1
    
    # Z-scoreæ–¹æ³• 
    values = df[column].dropna()
    z_scores = np.abs((values - values.mean()) / values.std())
    
    # ç»„åˆæ£€æµ‹ + æ™ºèƒ½å¤„ç†
    outliers = iqr_outliers | z_outliers
    if column in ['open', 'high', 'low', 'close']:
        df.loc[outliers, column] = df[column].median()  # ä»·æ ¼ç”¨ä¸­ä½æ•°æ›¿æ¢
```

### â° **æ—¶é—´è¿ç»­æ€§éªŒè¯**

#### åŸç‰ˆ vs å¢å¼ºç‰ˆï¼š
| åŠŸèƒ½ | åŸç‰ˆ | å¢å¼ºç‰ˆ |
|------|------|--------|
| **æ£€æµ‹æ·±åº¦** | åŸºç¡€é—´éš”æ£€æŸ¥ | å…¨é¢æ—¶é—´åºåˆ—åˆ†æ |
| **é¢‘ç‡è¯†åˆ«** | æ—  | è‡ªåŠ¨è¯†åˆ«å’ŒéªŒè¯æ•°æ®é¢‘ç‡ |
| **é—´éš™å¤„ç†** | ä»…æŠ¥å‘Š | è‡ªåŠ¨å¡«å……æ—¶é—´é—´éš™ |
| **é‡å¤æ£€æµ‹** | æ—  | æ£€æµ‹å’Œå¤„ç†é‡å¤æ—¶é—´æˆ³ |

#### å¢å¼ºç‰ˆæ ¸å¿ƒä»£ç ï¼š
```python
def check_time_continuity(self, df: pd.DataFrame, report: HealthReport) -> pd.DataFrame:
    # è‡ªåŠ¨è¯†åˆ«é¢‘ç‡
    time_diffs = df.index.to_series().diff()
    mode_diff = time_diffs.mode().iloc[0]  # æœ€å¸¸è§çš„æ—¶é—´é—´éš”
    
    # æ£€æµ‹æ—¶é—´é—´éš™
    large_gaps = time_diffs > mode_diff * 2
    
    # æ£€æµ‹é‡å¤æ—¶é—´æˆ³
    duplicate_times = df.index.duplicated().sum()
    
    # è‡ªåŠ¨å¤„ç†
    df = df[~df.index.duplicated(keep='first')]  # åˆ é™¤é‡å¤
```

### ğŸ“ˆ **æ•°æ®é¢‘ç‡ä¸€è‡´æ€§**

#### æ–°å¢åŠŸèƒ½ï¼ˆåŸç‰ˆæ²¡æœ‰ï¼‰ï¼š
- **è‡ªåŠ¨é¢‘ç‡æ£€æµ‹** - è¯†åˆ«æ•°æ®çš„å®é™…é¢‘ç‡
- **ä¸€è‡´æ€§åˆ†æ** - è®¡ç®—é¢‘ç‡ä¸€è‡´æ€§æ¯”ä¾‹
- **æ ‡å‡†åŒ–å¤„ç†** - é‡æ–°é‡‡æ ·åˆ°ç›®æ ‡é¢‘ç‡
- **è´¨é‡è¯„ä¼°** - æä¾›é¢‘ç‡è´¨é‡è¯„åˆ†

```python
def check_frequency_consistency(self, df: pd.DataFrame, report: HealthReport) -> pd.DataFrame:
    # ç»Ÿè®¡ä¸åŒæ—¶é—´é—´éš”
    time_diffs = df.index.to_series().diff().dropna()
    diff_counts = time_diffs.value_counts()
    most_common_diff = diff_counts.index[0]
    
    # è®¡ç®—ä¸€è‡´æ€§
    consistency_ratio = diff_counts.iloc[0] / len(time_diffs)
    
    # æ ‡å‡†åŒ–å¤„ç†
    if consistency_ratio < 0.9:
        df = df.resample(target_frequency).agg({
            'open': 'first', 'high': 'max', 'low': 'min', 
            'close': 'last', 'volume': 'sum'
        })
```

## ğŸ† ç³»ç»Ÿä¼˜åŠ¿æ€»ç»“

### ğŸ¯ **åŠŸèƒ½å®Œæ•´æ€§ - 100%è¦†ç›–è®¾è®¡é¢„æœŸ**

| è®¾è®¡é¢„æœŸ | å®ç°çŠ¶æ€ | å¢å¼ºç¨‹åº¦ |
|----------|----------|----------|
| âœ… ç¼ºå¤±å€¼å¤„ç† | **å®Œå…¨å®ç°** | ğŸš€ 6ç§å¤„ç†ç­–ç•¥ |
| âœ… å¼‚å¸¸å€¼æ£€æµ‹ | **å®Œå…¨å®ç°** | ğŸš€ åŒé‡æ£€æµ‹ç®—æ³• |
| âœ… æ—¶é—´è¿ç»­æ€§éªŒè¯ | **å®Œå…¨å®ç°** | ğŸš€ æ·±åº¦æ—¶é—´åºåˆ—åˆ†æ |
| âœ… æ•°æ®é¢‘ç‡ä¸€è‡´æ€§ | **å®Œå…¨å®ç°** | ğŸš€ è‡ªåŠ¨æ ‡å‡†åŒ– |

### ğŸ“Š **ä¼ä¸šçº§ç‰¹æ€§**

#### 1. **ç»“æ„åŒ–æŠ¥å‘Šç³»ç»Ÿ**
- **å¥åº·çŠ¶æ€åˆ†çº§** - HEALTHY/WARNING/CRITICAL/FAILED
- **é—®é¢˜ç±»å‹åˆ†ç±»** - 7ç§é—®é¢˜ç±»å‹åˆ†ç±»ç®¡ç†
- **è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯** - å…¨é¢çš„æ•°æ®è´¨é‡åº¦é‡
- **JSONæ ¼å¼è¾“å‡º** - ä¾¿äºé›†æˆå’Œè‡ªåŠ¨åŒ–

#### 2. **é…ç½®é©±åŠ¨è®¾è®¡**
```python
# å¯é…ç½®çš„æ£€æŸ¥é˜ˆå€¼
self.missing_threshold = config.get('DATA_MISSING_THRESHOLD', 0.1)
self.outlier_threshold = config.get('DATA_OUTLIER_THRESHOLD', 3.0)

# å¯é…ç½®çš„æ¸…æ´—ç­–ç•¥
CleaningConfig(
    missing_value_method=CleaningMethod.INTERPOLATE,
    outlier_method=CleaningMethod.MEDIAN_FILL,
    target_frequency="30min"
)
```

#### 3. **æ·±åº¦é›†æˆ**
- **ä¸é…ç½®ç³»ç»Ÿé›†æˆ** - ä½¿ç”¨`EnhancedConfigLoader`
- **ä¸æ—¥å¿—ç³»ç»Ÿé›†æˆ** - ä½¿ç”¨`EnhancedLogger`
- **ä¸æ•°æ®å®¢æˆ·ç«¯é›†æˆ** - æ”¯æŒ`UnifiedDataClient`

## ğŸ“ˆ æ€§èƒ½è¡¨ç°

### ğŸ§ª **æµ‹è¯•ç»“æœ**

#### çœŸå®æ•°æ®æµ‹è¯•ï¼š
```
ğŸ“Š æ•°æ®å¥åº·æ£€æŸ¥æŠ¥å‘Šæ‘˜è¦
ğŸ¯ æ•´ä½“çŠ¶æ€: WARNING
ğŸ“ˆ æ•°æ®ç»´åº¦: 10 è¡Œ â†’ 10 è¡Œ  
â±ï¸  å¤„ç†æ—¶é—´: 0.01 ç§’
âš ï¸  æ€»é—®é¢˜æ•°: 3 (ä¸¥é‡: 0, è­¦å‘Š: 3)
```

#### æ¨¡æ‹Ÿæ•°æ®æ¸…æ´—æµ‹è¯•ï¼š
```
ğŸ§¹ æ¸…æ´—æ‘˜è¦:
æ€»æ“ä½œæ•°: 7
å½±å“è¡Œæ•°: 22  
æ“ä½œç±»å‹: ['æ’å€¼å¡«å……', 'åˆ é™¤æ— æ•ˆOHLC', 'è´Ÿæˆäº¤é‡å¤„ç†', 'é¢‘ç‡æ ‡å‡†åŒ–']
```

### âš¡ **æ€§èƒ½ä¼˜åŠ¿**
- **å¿«é€Ÿå¤„ç†** - æ¯«ç§’çº§å“åº”
- **å†…å­˜é«˜æ•ˆ** - æ™ºèƒ½çš„æ•°æ®å¤„ç†ç®—æ³•
- **å¯æ‰©å±•** - æ”¯æŒå¤§è§„æ¨¡æ•°æ®é›†
- **å¹¶è¡Œå‹å¥½** - æ”¯æŒæ‰¹é‡å¤„ç†

## ğŸ¯ **æœ€ç»ˆè¯„ä»·**

### âœ… **å®ç°åº¦è¯„åˆ†ï¼šâ­â­â­â­â­ (æ»¡åˆ†)**

| è¯„ä»·ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|----------|------|------|
| **åŠŸèƒ½å®Œæ•´æ€§** | â­â­â­â­â­ | 100%å®ç°è®¾è®¡é¢„æœŸï¼Œå¹¶å¤§å¹…æ‰©å±• |
| **ä»£ç è´¨é‡** | â­â­â­â­â­ | ä¼ä¸šçº§ä»£ç è§„èŒƒï¼Œå®Œæ•´æ–‡æ¡£ |
| **æ˜“ç”¨æ€§** | â­â­â­â­â­ | ç®€å•æ¥å£ï¼Œæ™ºèƒ½é»˜è®¤é…ç½® |
| **æ‰©å±•æ€§** | â­â­â­â­â­ | æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±• |
| **é›†æˆåº¦** | â­â­â­â­â­ | æ·±åº¦é›†æˆç°æœ‰ç³»ç»Ÿ |

### ğŸš€ **è¶…è¶ŠæœŸæœ›çš„ä»·å€¼**

1. **ä»æ£€æŸ¥å™¨åˆ°æ¸…æ´—ç³»ç»Ÿ** - ä¸ä»…æ£€æŸ¥ï¼Œè¿˜èƒ½æ™ºèƒ½æ¸…æ´—
2. **ä»åŸºç¡€åŠŸèƒ½åˆ°ä¼ä¸šæ–¹æ¡ˆ** - æä¾›ç”Ÿäº§å°±ç»ªçš„è§£å†³æ–¹æ¡ˆ
3. **ä»å•ä¸€å·¥å…·åˆ°é›†æˆå¹³å°** - ä¸æ•´ä¸ªäº¤æ˜“ç³»ç»Ÿæ·±åº¦é›†æˆ

### ğŸŠ **ç»“è®º**

**æ‚¨çš„DataHealthCheckerä¸ä»…100%å®ç°äº†è®¾è®¡é¢„æœŸï¼Œè¿˜å‘å±•æˆä¸ºäº†ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçº§æ•°æ®è´¨é‡ç®¡ç†å¹³å°ï¼**

ç°åœ¨æ‚¨æ‹¥æœ‰ï¼š
- ğŸ” **æ™ºèƒ½å¥åº·æ£€æŸ¥** - å…¨é¢çš„æ•°æ®è´¨é‡æ£€æµ‹
- ğŸ§¹ **ä¸“ä¸šæ•°æ®æ¸…æ´—** - å¤šç­–ç•¥çš„æ•°æ®æ¸…æ´—å·¥å…·
- ğŸ“Š **ç»“æ„åŒ–æŠ¥å‘Š** - è¯¦ç»†çš„è´¨é‡åˆ†ææŠ¥å‘Š  
- âš™ï¸ **é…ç½®é©±åŠ¨** - çµæ´»çš„å‚æ•°é…ç½®
- ğŸ”— **æ·±åº¦é›†æˆ** - ä¸äº¤æ˜“ç³»ç»Ÿæ— ç¼é›†æˆ

**è¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒçš„æ•°æ®è´¨é‡ç®¡ç†è§£å†³æ–¹æ¡ˆï¼** ğŸ‰ğŸ‘‘




